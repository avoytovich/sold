!function(e){function t(n){if(s[n])return s[n].exports;var o=s[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var s={};t.m=e,t.c=s,t.d=function(e,s,n){t.o(e,s)||Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,s){"use strict";(function(e,t){var n=s(16),o=s(17),r=s(18),a=o.basename(e.filename),i=s(19).production,u={},c=void 0;c=i.use_env_variable?new r(process.env[i.use_env_variable]):new r(i.database,i.username,i.password,i),n.readdirSync(t).filter(function(e){return 0!==e.indexOf(".")&&e!==a&&".js"===e.slice(-3)}).forEach(function(e){var s=c.import(o.join(t,e));u[s.name]=s}),Object.keys(u).forEach(function(e){u[e].associate&&u[e].associate(u)}),u.sequelize=c,u.Sequelize=r,e.exports=u}).call(t,s(15)(e),"/")},function(e,t,s){"use strict";e.exports={TIME_TOKEN:"1d",messages:{congratulation:"Congratulation, you are logged!",password_is_not_valid:"Inputted password is not valid",account_is_not_activated:"Your account isn't activated",you_must_sign_up:"Before login you must sign up!",link_is_not_valid:"link is not valid",userNotFound:"userNotFound",linkAlreadyActivated:"linkAlreadyActivated",send_offer:"You have successfully send offer!",send_contact:"You have successfully send contact!",profile_was_successfully_updated:"profile was successfully updated",proposal_created_already:"Proposal have been created already!",proposal_added:"Proposal have been added!",not_permission_to_delete:"Sorry, you haven't permission to delete this proposal!",deleted_proposal:"Congratulation, you deleted proposal",profileError:"profileError",check_your_email:"Congratulation, check your email for activation"}}},function(e,t){e.exports={key:"home"}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("password-hash")},function(e,t,s){"use strict";var n=s(20),o=s(21),r=n.createTransport(o);e.exports={send:function(e){return r.sendMail(e,function(e,t){e&&console.log(e),console.log("Message sent:",t.messageId)})}}},function(e,t){e.exports=require("cloudinary")},function(e,t,s){"use strict";var n=s(8),o=s(9),r=s(10),a=s(11),i=n(),u=s(2),c=s(3),d=function(e){return e.headers["x-access-token"]},l=["/login","/user","/activation",""],f=function(e){return l.some(function(t){return e.match(t)})},p=function(e,t,s,n){return c.verify(e,u.key,function(e,o){return e&&t.status(401).json({message:"token is not valid"})||(s.decoded=o)&&n()})};i.use(o("dev")),i.use(a()),i.use(r.json()),i.use(r.urlencoded({extended:!1})),i.use("*",function(e,t,s){!d(e)&&!f(e.baseUrl)&&t.status(401).json({message:"no token"})||d(e)&&p(d(e),t,e,s)||f(e.baseUrl)&&s()}),s(12)(i),i.get("*",function(e,t){return t.status(200).send({message:"Welcome to the beginning of nothingness."})}),e.exports=i},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,s){"use strict";var n=s(13),o=n.userController,r=n.loginController,a=n.proposalsController,i=n.profileController,u=n.uploadController,c=n.offersController,d=s(27),l=s(6);e.exports=function(e){e.get("/test",function(e,t){return t.status(200).send({message:"Welcome"})}),e.post("/user",o.create),e.get("/user",i.retrieve),e.post("/login",r.login),e.get("/activation/:token",r.activation),e.put("/profile",i.update),e.post("/proposals",a.create),e.get("/proposals/list",a.list),e.get("/proposals/retrieve",a.retrieve),e.delete("/proposals/list/:proposal",a.destroy),e.post("/offers/list/email",c.create),e.post("/offers/list/retrieve",c.retrieve),e.post("/offers/reply/contact",c.rifle),l.config({cloud_name:"dtfm1ad4t",api_key:"567419891871528",api_secret:"hAVIKb3Cc77l0dm98yRuZARoLbw"});var t=d.memoryStorage(),s=d({storage:t});e.post("/upload",s.single("fileToUpload"),u.fileUploadMiddleware)}},function(e,t,s){"use strict";var n=s(14),o=s(22),r=s(23),a=s(24),i=s(25),u=s(26);e.exports={userController:n,loginController:o,proposalsController:r,profileController:a,uploadController:i,offersController:u}},function(e,t,s){"use strict";var n=s(4),o=s(3),r=s(0),a=r.User,i=s(2),u=s(1),c=s(5),d=c.send;e.exports={create:function(e,t){a.findOne({where:{email:e.body.email}}).then(function(s){s&&n.verify(e.body.password,s.password)&&t.status(400).json({message:"Email already in use"})||a.create({email:e.body.email,password:n.generate(e.body.password),isActivated:!1}).then(function(s){var n=o.sign({id:s.id,name:e.body.name},i.key,{expiresIn:u.TIME_TOKEN}),r={from:'"soldapp" <soldapp@ukr.net>',to:s.email,subject:"Registration for soldApp",text:"click on link to activate your account",html:'<b>click on link below to activate your account</b>\n                           <a href="http://localhost:8033/activation/'+n+'">link</a>'};d(r),t.status(200).json({message:u.messages.check_your_email})})}).catch(function(e){return t.status(404).send(e)})}}},function(e,t,s){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("sequelize")},function(e,t){e.exports={development:{username:"postgres",password:"235a532",database:"sold",host:"127.0.0.1",port:5432,dialect:"postgres"},test:{username:"root",password:null,database:"database_test",host:"127.0.0.1",dialect:"mysql"},production:{use_env_variable:"DATABASE_URL"}}},function(e,t){e.exports=require("nodemailer")},function(e,t){e.exports={host:"smtp.ukr.net",port:465,secure:!0,auth:{user:"soldapp@ukr.net",pass:"235a532235a532"}}},function(e,t,s){"use strict";var n=s(0),o=n.User,r=n.Profile,a=s(4),i=s(3),u=s(2),c=s(1);e.exports={login:function(e,t){o.findOne({where:{email:e.body.email}}).then(function(s){s&&a.verify(e.body.password,s.password)&&s.isActivated&&t.status(200).json({message:c.messages.congratulations,token:i.sign({id:s.id},u.key,{expiresIn:c.TIME_TOKEN})})||s&&s.isActivated&&t.status(400).json({message:c.messages.password_is_not_valid})||s&&!s.isActivated&&t.status(400).json({message:c.messages.account_is_not_activated})||!s&&t.status(400).json({message:c.messages.you_must_sign_up})}).catch(function(e){return t.status(401).send(e)})},activation:function(e,t){var s=e.params.token,n=i.verify(s,u.key,function(e,s){return s||t.status(498).json({message:c.messages.link_is_not_valid})});console.log(n),o.findById(n.id).then(function(e){!e&&t.status(404).json({message:c.messages.userNotFound})||e.isActivated&&t.status(418).json({message:c.messages.linkAlreadyActivated})||e.update({isActivated:!0})&&r.create({UserId:n.id,name:n.name})&&t.redirect("http://localhost:8080/")}).catch(function(e){return t.status(400).send(e)})}}},function(e,t,s){"use strict";var n=s(0),o=n.Proposals,r=s(1);e.exports={create:function(e,t){o.findOne({where:{title:e.body.title,UserId:e.decoded.id}}).then(function(s){s&&t.status(400).json({message:r.messages.proposal_created_already})||o.create({title:e.body.title,UserId:e.decoded.id})&&t.status(200).json({message:r.messages.proposal_added})}).catch(function(e){return t.status(404).send(e)})},list:function(e,t){var s=[];o.findAll().then(function(e){e.forEach(function(e){s.push(e.dataValues.title)}),s.reverse()}).then(function(){t.status(200).send(s)}).catch(function(e){return t.status(404).send(e)})},retrieve:function(e,t){var s=[];o.findAll({where:{UserId:e.decoded.id}}).then(function(e){e.forEach(function(e){s.push(e.dataValues.title)}),s.reverse()}).then(function(){t.status(200).send(s)}).catch(function(e){return t.status(404).send(e)})},destroy:function(e,t){o.findOne({where:{title:e.params.proposal,UserId:e.decoded.id}}).then(function(e){!e&&t.status(400).json({message:r.messages.not_permission_to_delete})||e.destroy().then(function(e){return t.status(200).json({message:r.messages.deleted_proposal})})}).catch(function(e){return t.status(400).send(e)})}}},function(e,t,s){"use strict";var n=s(0),o=n.Profile,r=s(1);e.exports={update:function(e,t){o.findOne({where:{UserId:e.decoded.id}}).then(function(s){s||t.status(404).json({message:"profileError"}),s.update(Object.assign({},e.body)).then(function(e){return t.status(200).json({profile:e,message:r.messages.profile_was_successfully_updated})}).catch(function(e){return t.status(400).send(e)})}).catch(function(e){return t.status(400).send(e)})},retrieve:function(e,t){o.findOne({where:{UserId:e.decoded.id}}).then(function(e){t.status(200).json({profile:e})}).catch(function(e){return t.status(400).send(e)})}}},function(e,t,s){"use strict";var n=s(6),o=s(0),r=o.Profile;s(1);e.exports={fileUploadMiddleware:function(e,t){n.uploader.upload_stream(function(s){r.findOne({where:{UserId:e.decoded.id}}).then(function(e){e||t.status(404).json({message:"profileError"}),e.update({avatar:s.url}).then(function(e){t.status(200).send(e.avatar)}).catch(function(e){return t.status(400).send(e)})}).catch(function(e){return t.status(400).send(e)})}).end(e.file.buffer)}}},function(e,t,s){"use strict";var n=s(0),o=n.Offers,r=n.Proposals,a=n.User,i=s(5),u=i.send,c=s(1);e.exports={create:function(e,t){r.findOne({include:[a],where:{title:e.body.title}}).then(function(s){var n={from:'"soldapp" <soldapp@ukr.net>',to:s.dataValues.User.email,subject:"Offer from soldApp",text:e.body.offer,html:"<b>Greeting from SoldApp! I have an offer to your proposal\n            "+e.body.title+". I want to suggest you "+e.body.offer+". Thanks</b>"};u(n),o.create({title:e.body.offer,ProposalsId:s.dataValues.id,UserId:e.decoded.id}).then(function(e){t.status(200).json({message:c.messages.send_offer})})}).catch(function(e){return t.status(400).send(e)})},retrieve:function(e,t){r.findOne({where:{UserId:e.decoded.id,title:e.body.title}}).then(function(e){o.findAll({where:{ProposalsId:e.dataValues.id}}).then(function(e){t.status(200).send(e)})}).catch(function(e){return t.status(400).send(e)})},rifle:function(e,t){o.findOne({include:[a],where:{title:e.body.title}}).then(function(s){r.findOne({include:[a],where:{id:s.dataValues.ProposalsId}}).then(function(n){a.findOne({where:{id:n.dataValues.UserId}}).then(function(n){var o={from:'"soldapp" <soldapp@ukr.net>',to:s.dataValues.User.email,subject:"user contact details, who are interested in your suggestion from soldApp",text:e.body.contact,html:"<b>Greeting from SoldApp, you've received this mail, because recently, you've suggested to me\n                    "+e.body.title+". I am excited about that and invite you to contact with me through this email\n                      "+n.dataValues.email+". Also, want to add some additional information "+e.body.contact+".\n                        Thank's</b>"};u(o),t.status(200).json({message:c.messages.send_contact})})})}).catch(function(e){return t.status(400).send(e)})}}},function(e,t){e.exports=require("multer")}]);